<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>微信机器人</title>
    <style type="text/css">
        div{
            text-align: center;
            margin: 10px 0;
        }
        #btn{
            display: none;
        }
        .button{
            width: 120px;
            height: 40px;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
        }
        .qr img{
            display: none;
            width: 360px;
            height: 360px;
            border-radius: 10px;
            border:8px solid #eae8e8;
        }
        #success div{
            margin: 10px 0;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="qr">
        <img />
        <div id="success" style="display:none;">
            <div id="info"></div>
            <div>登录成功！</div>
        </div>
    </div>
    <div id="btn">
        <button class="button" onclick="login()">登录</button>
    </div>
</body>
<script src="/jquery.min.js"></script>
<script>
    function check_status(){
        $.get("/check_status",function(data){
            switch (data.status) {
                case 0:
                case 2:
                case 4:
                    $("#success").hide();
                    $("#btn").show();
                    $("img").show();
                    $("img").removeAttr("src");
                    break;
                case 1:
                    $("#btn").hide();
                    $("img").attr("src", "/qrcode.png");
                    break;
                case 3:
                    $("#btn").hide();
                    $("img").hide();
                    $("#success").show();
                    $("#info").html(data.info.User.NickName);
                    break;
            }
      });
    }
    $(function(){
      setInterval(function(){
          check_status();
          console.log('----------------------------');
      }, 2000);
    });
    function login() {
        $("#btn").hide();
        $.get("/login");
    }
</script>
</html>